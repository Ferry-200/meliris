# Meliris: An Intelligent System for LRC Enhancement based on Vocal Detection

## 模型方案设计

### 一、总体思路

本项目旨在构建一个**结合人声检测与演唱者区分**的 LRC 歌词自动优化系统，
目标是在较小的训练数据量（500 首音乐）下
实现高精度、可解释、具备实时性的预测结果。

在前期实验中，LSTM 模型已经能较好地捕捉人声时序规律，
但在遇到复杂伴奏、间奏或歌声变化时仍存在以下问题：

* 模型对音色和节奏变化敏感度不足；
* 预测稳定性偏低；
* 对人声与间奏的置信度差距有限；
* 模型在噪声和多乐器干扰下容易误判。

因此，在后续模型方案中，重点从两个方向进行改进：

> **(1)** 用 CNN + LSTM 结构提取更稳健的时频特征；
> **(2)** 引入注意力机制（Attention）增强模型对关键时刻和特征的关注能力。

### 二、CNN + LSTM 结构

#### 2.1 设计思路

* **CNN（卷积神经网络）** 用于从音频的 Mel 频谱中提取局部时频模式，能捕捉到：

  * 不同频段的谐波结构；
  * 乐器与人声的频谱差异；
  * 人声的共振特征与能量集中区。

* **LSTM（长短期记忆网络）** 用于处理 CNN 输出的时间序列特征，
  建模音乐在时间维度上的依赖关系，如：

  * 人声音节之间的持续与间断；
  * 歌曲结构变化；
  * 间奏的节奏规律。

CNN 提供高层局部特征，LSTM 建立时间关系，
两者结合能够让模型兼具“听觉细节”与“时序记忆”。

#### 2.2 模型结构示意（文本描述）

```
输入：Mel 频谱 (T × F)
 ↓
2D 卷积层（Conv2D + ReLU + Pooling）
 ↓
特征展平 (Flatten)
 ↓
LSTM 层
 ↓
时间分布全连接层（TimeDistributed Dense）
 ↓
Sigmoid 输出（预测每帧为人声的概率）
```

#### 2.3 优点分析

| 特点 | 优势 |
| ---- | ---- |
| CNN 负责局部频谱提取 | 减少频率噪声影响，捕捉音色模式 |
| LSTM 负责时间建模 | 保留上下文语义，处理延续性人声 |
| 结构轻量 | 可在 CPU 或移动设备上运行 |
| 对训练量要求低 | 适合 500 首以内数据集   |

### 三、引入注意力机制（Attention Mechanism）

#### 3.1 设计动机

在音乐中，人声只占总时长的一部分，而间奏和伴奏往往会干扰识别。
传统的 CNN + LSTM 模型会平均处理所有时间步，导致：

* 模型在短暂停顿或弱声段预测不稳定；
* 伴奏强烈时置信度被拉低；
* 难以区分主唱与伴唱。

为此，引入 **注意力机制（Attention）**，让模型自动“聚焦”于
关键的时间步或频率区段，从而提升预测精度。

#### 3.2 实现方案

1. **时间注意力（Temporal Attention）**

   * 在 LSTM 输出的时间序列上计算权重；
   * 让模型自动聚焦在人声起止、歌词变换处；
   * 形式轻量、适合实时推理。

2. **频谱注意力（Spectral Attention）**

   * 在 CNN 输出的频谱维度上计算通道加权；
   * 强化人声所在频段（约 1–4kHz）的特征；
   * 抑制鼓点、低频伴奏干扰。

3. **组合式注意力（Temporal + Spectral）**

   * 先在时间维度进行加权，再在频谱维度做通道注意；
   * 提升复杂音乐中间奏段与人声段的区分能力。

#### 3.3 注意力可视化意义

* 可将注意力权重映射回音频时间轴；
* 形成“模型听觉热力图”；
* 辅助解释模型决策逻辑，提高结果可解释性。

### 四、预期效果

| 模型方案 | 主要特征 | 优点 | 可能问题 |
| -------- | -------- | ---- | -------- |
| 原始 LSTM | 单层时序建模 | 简单、稳定 | 容易忽略细节、误判间奏 |
| CNN + LSTM | 局部特征 + 时序建模 | 稳定性强、特征丰富 | 对少量数据敏感 |
| CNN + LSTM + Attention | 动态聚焦关键帧 | 区分更清晰、置信度更高、可解释 | 计算量略增、需调参 |

### 五、总结

> CNN + LSTM 提供“**听得更全**”的能力，
> Attention 赋予模型“**听得更准**”的能力。

两者结合能在有限训练数据下显著提升人声与间奏的区分度，
为后续的演唱者区分与 LRC 精准对齐奠定基础。
